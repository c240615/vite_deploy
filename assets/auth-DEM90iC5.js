import{a as s}from"./axios-5KWFXKlW.js";import{i as c,m as r}from"./index-ruAEl9v8.js";import{u as h}from"./ToastComponent-De44Fyty.js";var u={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"claire_vue3_apipath",VITE_GITHUB:"https://github.com/c240615/vite_deploy",BASE_URL:"/vite_deploy/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:a}=u,p=c({id:"auth",state:()=>({isAuthenticated:!1,user:null}),actions:{...r(h,["showToast"]),login(e){const o=`${a}/admin/signin`;s.post(o,e).then(t=>{const{token:i,expired:n}=t.data;return document.cookie=`hexToken=${i}; expires=${new Date(n)}`,t}).then(t=>{localStorage.setItem("isLoggedIn","true"),this.isAuthenticated=!0,this.user={useremail:e.username}}).catch(t=>{this.showToast(t.data.message,"error")})},logout(){const e=`${a}/logout`;s.post(e).then(o=>{document.cookie="hexToken=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;"}).then(()=>{this.isAuthenticated=!1,this.user=null,localStorage.setItem("isLoggedIn","false"),this.showToast("登出成功","success")}).catch(o=>{console.log(o)})},checkLogin(){const e=`${a}/api/user/check`;s.post(e).then(()=>{this.isAuthenticated=!0,localStorage.setItem("isLoggedIn","true")}).catch(()=>{this.isAuthenticated=!1,localStorage.setItem("isLoggedIn","false")})},getToken(){const e=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");e&&(s.defaults.headers.common.Authorization=e),this.checkLogin()}}});export{p as u};
